<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pysrc.uhdl.core.Variable &mdash; ltool 0.01 文档</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
        <script src="../../../../_static/translations.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../../../genindex.html" />
    <link rel="search" title="搜索" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../../index.html" class="icon icon-home"> ltool
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="搜索文档" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="导航菜单">
              <!-- Local TOC -->
              <div class="local-toc"></div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="移动版导航菜单" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">ltool</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="页面导航">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">模块代码</a></li>
      <li class="breadcrumb-item active">pysrc.uhdl.core.Variable</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>pysrc.uhdl.core.Variable 源代码</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">math</span><span class="o">,</span> <span class="nn">re</span><span class="o">,</span> <span class="nn">string</span>

<span class="kn">from</span> <span class="nn">enum</span>       <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="nn">functools</span>  <span class="kn">import</span> <span class="n">reduce</span>
<span class="kn">from</span> <span class="nn">operator</span>   <span class="kn">import</span> <span class="n">concat</span>
<span class="kn">from</span> <span class="nn">copy</span>       <span class="kn">import</span> <span class="n">copy</span>

<span class="kn">from</span> <span class="nn">.Root</span>      <span class="kn">import</span> <span class="n">Root</span>
<span class="kn">from</span> <span class="nn">.</span>          <span class="kn">import</span> <span class="n">Component</span>

<span class="kn">from</span> <span class="nn">.Exception</span>     <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.InternalTool</span>  <span class="kn">import</span> <span class="o">*</span>


<span class="c1">#   Root</span>
<span class="c1">#       Variable</span>
<span class="c1">#       Bundle</span>
<span class="c1">#   ValueRoot</span>
<span class="c1">#       Value</span>
<span class="c1">#           Expression</span>
<span class="c1">#               Constant</span>
<span class="c1">#                   Bits</span>
<span class="c1">#                       UInt</span>
<span class="c1">#                       SInt</span>
<span class="c1">#       Value, Variable</span>
<span class="c1">#           SingleVar</span>
<span class="c1">#               WireSig</span>
<span class="c1">#                   IOSig</span>
<span class="c1">#                       Input</span>
<span class="c1">#                       Output</span>
<span class="c1">#                       Inout</span>
<span class="c1">#                   Wire</span>
<span class="c1">#               Reg</span>


<div class="viewcode-block" id="Variable"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Variable">[文档]</a><span class="k">class</span> <span class="nc">Variable</span><span class="p">(</span><span class="n">Root</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rvalue</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_des_lvalue</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rvalue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rvalue</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name_until_component</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_until</span><span class="p">(</span><span class="n">Component</span><span class="o">.</span><span class="n">Component</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name_before_component</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_before</span><span class="p">(</span><span class="n">Component</span><span class="o">.</span><span class="n">Component</span><span class="p">)</span>
            
    <span class="c1"># def __gt__(self,other):</span>
    <span class="c1">#     if not isinstance(other,Variable):  raise ErrVarCmpWrong(&#39;%s should compare with a Variable,but get a %s.&#39; % (GetClsNameFromObj(self),GetClsNameFromObj(other)))</span>
    <span class="c1">#     if self.name == other.name:         raise ErrVarCmpWrong(&#39;Two Variable with the same name &quot;%s&quot; cannot be compared.&#39; % (self.name))</span>
    <span class="c1">#     if self.name &gt; other.name:          return True</span>
    <span class="c1">#     else:                               return False</span>
<span class="c1"># # </span>
    <span class="c1"># def __lt__(self,other):</span>
    <span class="c1">#     return not self.__gt__(other)</span>

    <span class="c1">#def __str__(self):</span>
    <span class="c1">#    return &quot;343&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">var_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>

    <span class="c1"># += as circuit assignment</span>
    <span class="k">def</span> <span class="fm">__iadd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">rvalue</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rvalue</span><span class="p">,</span><span class="n">Value</span><span class="p">):</span>        <span class="k">raise</span> <span class="n">ErrAssignTypeWrong</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">rvalue</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute</span> <span class="o">!=</span> <span class="n">rvalue</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>  <span class="k">raise</span> <span class="n">ErrAttrMismatch</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> is expected to be connected by a Rvalue with same attribute,but the current attribute does not match.&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_name</span> <span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">rvalue</span><span class="p">)</span>
        <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_rvalue&#39;</span><span class="p">,</span> <span class="n">rvalue</span><span class="p">)</span>
        <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">rvalue</span><span class="p">,</span> <span class="s1">&#39;_des_lvalue&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

        <span class="n">self_module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">father_until</span><span class="p">(</span><span class="n">Component</span><span class="o">.</span><span class="n">Component</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rvalue</span><span class="p">,</span> <span class="n">CutExpression</span><span class="p">):</span>
            <span class="n">rvalue_module</span> <span class="o">=</span> <span class="n">rvalue</span><span class="o">.</span><span class="n">op</span><span class="o">.</span><span class="n">father_until</span><span class="p">(</span><span class="n">Component</span><span class="o">.</span><span class="n">Component</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rvalue</span><span class="p">,</span> <span class="n">Expression</span><span class="p">):</span>
            <span class="n">rvalue_module</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rvalue_module</span> <span class="o">=</span> <span class="n">rvalue</span><span class="o">.</span><span class="n">father_until</span><span class="p">(</span><span class="n">Component</span><span class="o">.</span><span class="n">Component</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rvalue</span><span class="p">,</span> <span class="n">Expression</span><span class="p">):</span>
            <span class="c1"># rvalue is expression, lvalue can be all signal.</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">rvalue_module</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">self_module</span> <span class="ow">is</span> <span class="n">rvalue_module</span><span class="p">:</span>
                <span class="c1"># internal connection.</span>
                <span class="c1">#    -------------------</span>
                <span class="c1">#    |                 |</span>
                <span class="c1">#    |  (lhs)  (rhs)   |</span>
                <span class="c1">#    |                 |</span>
                <span class="c1">#    -------------------</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Input</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">ErrUHDLStr</span><span class="p">(</span><span class="s2">&quot;lhs </span><span class="si">%s</span><span class="s2"> and rhs </span><span class="si">%s</span><span class="s2"> have same father Component </span><span class="si">%s</span><span class="s2">, bus lhs is Input, it</span><span class="se">\&#39;</span><span class="s2">s illegal.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rvalue</span><span class="p">,</span> <span class="n">self_module</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">self_module</span><span class="o">.</span><span class="n">father</span> <span class="ow">is</span> <span class="n">rvalue_module</span><span class="o">.</span><span class="n">father</span><span class="p">:</span>
                <span class="c1"># same level connection.</span>
                <span class="c1">#    ------------------   ------------------</span>
                <span class="c1">#    |                |   |                |</span>
                <span class="c1">#    |          (lhs)&lt;-   &lt;-(rhs)          |</span>
                <span class="c1">#    |                |   |                |</span>
                <span class="c1">#    ------------------   ------------------</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Input</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">ErrUHDLStr</span><span class="p">(</span><span class="s2">&quot;lhs </span><span class="si">%s</span><span class="s2">&#39;s father Component and rhs </span><span class="si">%s</span><span class="s2">&#39;s father Component are in same Component, so lhs should be Input.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rvalue</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">self_module</span><span class="o">.</span><span class="n">father</span> <span class="ow">is</span> <span class="n">rvalue_module</span><span class="p">:</span>
                <span class="c1"># lhs in low level</span>
                <span class="c1">#    ----------------------</span>
                <span class="c1">#    |                    |</span>
                <span class="c1">#    |    ---------       |</span>
                <span class="c1">#    |    |       |       |</span>
                <span class="c1">#    |    | (lhs)&lt;-  (rhs)|</span>
                <span class="c1">#    |    |       |       |</span>
                <span class="c1">#    |    ---------       |</span>
                <span class="c1">#    |                    |</span>
                <span class="c1">#    ----------------------</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Input</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">ErrUHDLStr</span><span class="p">(</span><span class="s2">&quot;lhs </span><span class="si">%s</span><span class="s2">&#39;s father Component is in rhs </span><span class="si">%s</span><span class="s2">&#39;s father Component, so lhs should be Input.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rvalue</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">self_module</span> <span class="ow">is</span> <span class="n">rvalue_module</span><span class="o">.</span><span class="n">father</span><span class="p">:</span>
                <span class="c1"># rhs in low level</span>
                <span class="c1">#    ----------------------</span>
                <span class="c1">#    |                    |</span>
                <span class="c1">#    |    ---------       |</span>
                <span class="c1">#    |    |       |       |</span>
                <span class="c1">#    |    | (rhs)-&gt;  (lhs)|</span>
                <span class="c1">#    |    |       |       |</span>
                <span class="c1">#    |    ---------       |</span>
                <span class="c1">#    |                    |</span>
                <span class="c1">#    ----------------------</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rvalue</span><span class="p">,</span> <span class="n">Output</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">ErrUHDLStr</span><span class="p">(</span><span class="s2">&quot;rhs </span><span class="si">%s</span><span class="s2">&#39;s father Component is in lhs </span><span class="si">%s</span><span class="s2">&#39;s father Component, so rhs should be Output.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rvalue</span><span class="p">))</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Input</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">ErrUHDLStr</span><span class="p">(</span><span class="s2">&quot;rhs </span><span class="si">%s</span><span class="s2">&#39;s father Component is in lhs </span><span class="si">%s</span><span class="s2">&#39;s father Component, so lhs should not be Input.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rvalue</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># illegal hier.</span>
                <span class="k">raise</span> <span class="n">ErrUHDLStr</span><span class="p">(</span><span class="s2">&quot;The hier where lhs </span><span class="si">%s</span><span class="s2"> and rhs </span><span class="si">%s</span><span class="s2"> are located cannot be legally connected.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rvalue</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># rvalue is a unregsitered signal.</span>
            <span class="k">raise</span> <span class="n">ErrUHDLStr</span><span class="p">(</span><span class="s2">&quot;rhs </span><span class="si">%s</span><span class="s2"> does not have a legal component father, it may not be registered into a component.&quot;</span> <span class="o">%</span> <span class="n">rvalue</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_need_always</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rvalue</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rvalue</span><span class="p">,</span> <span class="n">AlwaysCombExpression</span><span class="p">))</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Reg</span><span class="p">)</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">verilog_assignment</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_rvalue&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rvalue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_need_always</span><span class="p">:</span>
            <span class="n">str_list</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rvalue</span><span class="o">.</span><span class="n">bstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s2">&quot;=&quot;</span><span class="p">)</span>
            <span class="n">str_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;always @(*) </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">str_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">str_list</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;assign &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lstring</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rvalue</span><span class="o">.</span><span class="n">rstring</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;&#39;</span><span class="p">]</span></div>





<div class="viewcode-block" id="Bundle"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Bundle">[文档]</a><span class="k">class</span> <span class="nc">Bundle</span><span class="p">(</span><span class="n">Root</span><span class="p">):</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rvalue</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_var_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rvalue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rvalue</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name_until_component</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_until_not</span><span class="p">(</span><span class="n">Bundle</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name_before_component</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_before_not</span><span class="p">(</span><span class="n">Bundle</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_var_list&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_var_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="n">Bundle</span><span class="p">,</span> <span class="n">Variable</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_var_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setattr_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">component_father</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">father_until</span><span class="p">(</span><span class="n">Component</span><span class="o">.</span><span class="n">Component</span><span class="p">)</span>
        <span class="c1">#print(self)</span>
        <span class="c1">#print(self.father)</span>
        <span class="c1">#print(component_father)</span>
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_var_list</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">component_father</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">name_before</span><span class="p">(</span><span class="n">Component</span><span class="o">.</span><span class="n">Component</span><span class="p">),</span> <span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">io_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">IOSig</span><span class="p">)]</span>



<div class="viewcode-block" id="Bundle.reverse"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Bundle.reverse">[文档]</a>    <span class="k">def</span> <span class="nf">reverse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">reverse</span> <span class="o">=</span> <span class="n">Bundle</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">io_list</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">reverse</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_&#39;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">i</span><span class="o">.</span><span class="n">reverse</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">reverse</span></div>



    <span class="c1"># def exclude(self,*exclude_list):</span>


    <span class="c1">#     res_list = []</span>
    <span class="c1">#     exclude_list = [&#39;%s_%s&#39; % (self.name, item) for item in exclude_list]</span>
    <span class="c1">#     for var in self._var_list:</span>
    <span class="c1">#         if var.name not in exclude_list:</span>
    <span class="c1">#             res_list.append(var)</span>
    <span class="c1">#     return res_list</span>




<div class="viewcode-block" id="Bundle.as_list"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Bundle.as_list">[文档]</a>    <span class="k">def</span> <span class="nf">as_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">exclude_list</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">exclude</span>
        <span class="n">res_list</span> <span class="o">=</span> <span class="p">[]</span>


        <span class="n">exclude_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">exclude_list</span><span class="p">]</span>
        <span class="c1">#print(exclude_list)</span>
        <span class="c1">#print( self._var_list)</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_var_list</span><span class="p">:</span>
            <span class="c1">#print(&#39;var&#39;, var.name)</span>
            <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude_list</span><span class="p">:</span>
                <span class="n">res_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res_list</span></div>


<div class="viewcode-block" id="Bundle.connect"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Bundle.connect">[文档]</a>    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">pass</span></div>


    <span class="c1">#@property</span>
    <span class="c1">#def name(self) -&gt; str:</span>
    <span class="c1">#    from .Component import Component</span>
    <span class="c1">#    return self.name_until_not(Component)</span>

<div class="viewcode-block" id="Bundle.exclude"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Bundle.exclude">[文档]</a>    <span class="k">def</span> <span class="nf">exclude</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="nb">delattr</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


    


<div class="viewcode-block" id="ValueRoot"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.ValueRoot">[文档]</a><span class="k">class</span> <span class="nc">ValueRoot</span><span class="p">():</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="Value"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Value">[文档]</a><span class="k">class</span> <span class="nc">Value</span><span class="p">(</span><span class="n">ValueRoot</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rvalue</span>     <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_des_lvalue</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span>


<div class="viewcode-block" id="Value.check_rvalue"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Value.check_rvalue">[文档]</a>    <span class="k">def</span> <span class="nf">check_rvalue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">:</span> <span class="n">ValueRoot</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;This function is used to check the validity of rvalue, rvalue must be of type ValueRoot or its subclass.&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">ValueRoot</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ErrExpInTypeWrong</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span><span class="nb">slice</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">CutExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">stop</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">CutExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="c1">#def Cut(self, hbound:int, lbound:int):</span>
    <span class="c1">#    return CutExpression(self, hbound, lbound)</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">AddExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">SubExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">MulExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">BitAndExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">BitOrExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__xor__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">BitXorExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__invert__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">InverseExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__lshift__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">LeftShift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__rshift__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">RightShift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>


    <span class="c1"># Redefining comparison-related operators can lead to logical abnormalities such as sorting</span>

    <span class="c1"># def __lt__(self,rhs):</span>
    <span class="c1">#     return Less(self,rhs)</span>

    <span class="c1"># def __le__(self,rhs):</span>
    <span class="c1">#     return LessEqual(self,rhs)</span>
 
    <span class="c1"># def __gt__(self,rhs):</span>
    <span class="c1">#     return Greater(self,rhs)</span>
 
    <span class="c1"># def __ge__(self,rhs):</span>
    <span class="c1">#     return GreaterEqual(self,rhs)</span>
 
    <span class="c1"># def __eq__(self,rhs):</span>
    <span class="c1">#     return Equal(self,rhs)</span>
 
    <span class="c1"># def __ne__(self,rhs):</span>
    <span class="c1">#     return NotEqual(self,rhs)</span>




    <span class="c1">#@property</span>
    <span class="c1">#def is_lvalue(self) -&gt; bool:</span>
    <span class="c1">#    return False</span>

    <span class="c1">#@property</span>
    <span class="c1">#def string(self):</span>
    <span class="c1">#    raise NotImplementedError</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lstring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="c1">#@property</span>
<div class="viewcode-block" id="Value.rstring"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Value.rstring">[文档]</a>    <span class="k">def</span> <span class="nf">rstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lvalue</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="Value.bstring"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Value.bstring">[文档]</a>    <span class="k">def</span> <span class="nf">bstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lvalue</span><span class="p">,</span> <span class="n">assign_method</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">lvalue</span><span class="o">.</span><span class="n">lstring</span><span class="p">,</span> <span class="n">assign_method</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rstring</span><span class="p">(</span><span class="n">lvalue</span><span class="p">)])</span> <span class="o">+</span> <span class="s2">&quot;;&quot;</span><span class="p">]</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">des_connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_des_lvalue</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">src_connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rvalue</span></div>








<div class="viewcode-block" id="SingleVar"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.SingleVar">[文档]</a><span class="k">class</span> <span class="nc">SingleVar</span><span class="p">(</span><span class="n">Variable</span><span class="p">,</span> <span class="n">Value</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">template</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="n">Constant</span><span class="p">):</span> <span class="k">raise</span> <span class="n">ErrAttrTypeWrong</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">template</span><span class="p">)</span>
        <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_template&#39;</span><span class="p">,</span> <span class="n">template</span><span class="p">)</span>
        <span class="c1">#self.__template = template</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_template</span><span class="o">.</span><span class="n">width</span>

    <span class="c1">#@property</span>
    <span class="c1">#def string(self):</span>
    <span class="c1">#    return self.name_before_component #self.__name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lstring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_before_component</span> <span class="c1">#self.__name</span>

    <span class="c1">#@property</span>
<div class="viewcode-block" id="SingleVar.rstring"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.SingleVar.rstring">[文档]</a>    <span class="k">def</span> <span class="nf">rstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lvalue</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_before_component</span> <span class="c1">#self.__name</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_template</span></div>




<div class="viewcode-block" id="WireSig"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.WireSig">[文档]</a><span class="k">class</span> <span class="nc">WireSig</span><span class="p">(</span><span class="n">SingleVar</span><span class="p">):</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="Reg"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Reg">[文档]</a><span class="k">class</span> <span class="nc">Reg</span><span class="p">(</span><span class="n">SingleVar</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Reg is used to define a register in Component in UHDL. </span>

<span class="sd">        UInt/SInt T          - type template</span>
<span class="sd">        rhs       C          - UInt(1)</span>
<span class="sd">        rhs       R          - UInt(1) (default=None)</span>
<span class="sd">        bool      asyncrst   - True for aysnc reset,False for sync reset. (default=True)</span>
<span class="sd">        bool      rstactive  - True for low active,False for high acitve. (default=False)</span>
<span class="sd">        bool      clkactive  - True for negedge trigger,False for posedge trigger. (default=False)</span>

<span class="sd">    Reg needs a UHDL constant as a template to declare its type. </span>
<span class="sd">    Its type will be consistent with the constants they use as templates.</span>

<span class="sd">    Reg needs a signal as its clock.</span>

<span class="sd">    Reg needs a signal as its reset.</span>

<span class="sd">    Reg also requires 3 Boolean variables to determine the effective level of reset, reset mode, and clock trigger edge.</span>

<span class="sd">    A typical example is</span>

<span class="sd">            Reg(UInt(32),clk,rst)</span>

<span class="sd">    This example describes a register whose clock is clk, reset is rst, and the type is an unsigned 32-bit integer.</span>
<span class="sd">    And this register is triggered on the rising edge of the clock, using low level asynchronous reset.</span>

<span class="sd">    Another example is</span>

<span class="sd">            Reg(SInt(16),clk,rst,False,True,True)</span>

<span class="sd">    This example describes a register whose clock is clk, reset is rst, and the type is an signed 16-bit integer.</span>
<span class="sd">    And this register is triggered on the falling edge of the clock, using high level synchronous reset.</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">template</span><span class="p">,</span><span class="n">clk</span><span class="p">:</span><span class="n">SingleVar</span><span class="p">,</span><span class="n">rst</span><span class="p">:</span><span class="n">SingleVar</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">async_rst</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">rst_active_low</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">clk_active_neg</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="n">template</span><span class="p">)</span>
        <span class="c1"># input value check</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_rvalue</span><span class="p">(</span><span class="n">clk</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rst</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_rvalue</span><span class="p">(</span><span class="n">rst</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">async_rst</span>     <span class="p">,</span><span class="nb">bool</span><span class="p">):</span> <span class="k">raise</span> <span class="n">ErrNeedBool</span><span class="p">(</span><span class="s1">&#39;Reg</span><span class="se">\&#39;</span><span class="s1">s input async_rst need a bool value,bug get a </span><span class="si">%s</span><span class="s1">&#39;</span>      <span class="o">%</span> <span class="n">async_rst</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rst_active_low</span><span class="p">,</span><span class="nb">bool</span><span class="p">):</span> <span class="k">raise</span> <span class="n">ErrNeedBool</span><span class="p">(</span><span class="s1">&#39;Reg</span><span class="se">\&#39;</span><span class="s1">s input rst_active_low need a bool value,bug get a </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">rst_active_low</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">clk_active_neg</span><span class="p">,</span><span class="nb">bool</span><span class="p">):</span> <span class="k">raise</span> <span class="n">ErrNeedBool</span><span class="p">(</span><span class="s1">&#39;Reg</span><span class="se">\&#39;</span><span class="s1">s input clk_active_neg need a bool value,bug get a </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">clk_active_neg</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_aclk</span>           <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rst</span>            <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_async_rst</span>      <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rst_active_low</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clk_active_neg</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;_aclk&#39;</span><span class="p">,</span><span class="n">clk</span><span class="p">)</span>
        <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;_rst&#39;</span><span class="p">,</span><span class="n">rst</span><span class="p">)</span>
        <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;_async_rst&#39;</span><span class="p">,</span><span class="n">async_rst</span><span class="p">)</span>
        <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;_rst_active_low&#39;</span><span class="p">,</span><span class="n">rst_active_low</span><span class="p">)</span>
        <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;_clk_active_neg&#39;</span><span class="p">,</span><span class="n">clk_active_neg</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">verilog_assignment</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;_rvalue&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rvalue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sensitivity_list</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;negedge&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clk_active_neg</span> <span class="k">else</span> <span class="s2">&quot;posedge&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aclk</span><span class="o">.</span><span class="n">rstring</span><span class="p">(</span><span class="bp">self</span><span class="p">)]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rst</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_async_rst</span><span class="p">:</span>
                <span class="n">sensitivity_list</span> <span class="o">+=</span> <span class="p">[(</span><span class="s2">&quot;negedge&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rst_active_low</span> <span class="k">else</span> <span class="s2">&quot;posedge&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rst</span><span class="o">.</span><span class="n">rstring</span><span class="p">(</span><span class="bp">self</span><span class="p">)]</span>

            <span class="n">str_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;always @(</span><span class="si">%s</span><span class="s1">) begin&#39;</span> <span class="o">%</span><span class="p">(</span><span class="s2">&quot; or &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sensitivity_list</span><span class="p">))]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rst</span><span class="p">:</span>
                <span class="n">str_list</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;    if(</span><span class="si">%s%s</span><span class="s1">) </span><span class="si">%s</span><span class="s1"> &lt;= </span><span class="si">%s</span><span class="s1">;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;~&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rst_active_low</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_rst</span><span class="o">.</span><span class="n">rstring</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">lstring</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">rstring</span><span class="p">(</span><span class="bp">self</span><span class="p">))]</span> 
                <span class="n">tmp_str_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rvalue</span><span class="o">.</span><span class="n">bstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">)</span>
                <span class="n">tmp_str_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;    else </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">tmp_str_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">tmp_str_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;    </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tmp_str_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
                <span class="n">str_list</span> <span class="o">+=</span> <span class="n">tmp_str_list</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">str_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rvalue</span><span class="o">.</span><span class="n">bstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">)</span>
                <span class="n">str_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;    </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">str_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">tmp_str_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;    </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tmp_str_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">str_list</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">str_list</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">verilog_def</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;生成端口定义的RTL&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;reg [</span><span class="si">%s</span><span class="s1">:0] </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">width</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">name_before_component</span><span class="p">)]</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">verilog_def_as_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;reg&#39;</span><span class="p">,</span><span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">:0]&#39;</span><span class="o">%</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">width</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span><span class="bp">self</span><span class="o">.</span><span class="n">name_before_component</span><span class="p">]</span></div>






<div class="viewcode-block" id="Wire"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Wire">[文档]</a><span class="k">class</span> <span class="nc">Wire</span><span class="p">(</span><span class="n">WireSig</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Wire is used to declare an internal signal wire in Component in UHDL.</span>

<span class="sd">    Wire needs a UHDL constant as a template to declare its type. </span>
<span class="sd">    Its type will be consistent with the constants they use as templates.</span>

<span class="sd">    A typical example is</span>

<span class="sd">            Wire(UInt(32))</span>

<span class="sd">    The type of Wire in this example will be consistent with UInt(32), </span>
<span class="sd">    that is, it is a 32-bit unsigned integer.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1">#=============================================================================================</span>
    <span class="c1"># RTL gen </span>
    <span class="c1">#=============================================================================================</span>

    <span class="c1"># @property</span>
    <span class="c1"># def verilog_inst(self):</span>
    <span class="c1">#     &#39;&#39;&#39;生成端口实例化的RTL&#39;&#39;&#39;</span>
    <span class="c1">#     return [&quot;.%s(%s)&quot; %(self.name_before(Component),self.name_until(Component))]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">verilog_def</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;生成端口定义的RTL&#39;&#39;&#39;</span>
        <span class="n">def_keyword</span> <span class="o">=</span> <span class="s1">&#39;reg&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_need_always</span> <span class="k">else</span> <span class="s1">&#39;wire&#39;</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> [</span><span class="si">%s</span><span class="s1">:0] </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">def_keyword</span><span class="p">,(</span><span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">width</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">name_before_component</span><span class="p">)]</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">verilog_def_as_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">def_keyword</span> <span class="o">=</span> <span class="s1">&#39;reg&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_need_always</span> <span class="k">else</span> <span class="s1">&#39;wire&#39;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">def_keyword</span><span class="p">,</span><span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">:0]&#39;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">width</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">name_before_component</span><span class="p">]</span></div>




<div class="viewcode-block" id="IOSig"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.IOSig">[文档]</a><span class="k">class</span> <span class="nc">IOSig</span><span class="p">(</span><span class="n">WireSig</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">verilog_inst</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;生成端口实例化的RTL&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;.</span><span class="si">%s</span><span class="s2">(</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name_before_component</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">name_until_component</span><span class="p">)]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">verilog_outer_def</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;生成信号声明的RTL&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;wire </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">width</span><span class="o">==</span><span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">:0]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">width</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">name_until_component</span><span class="p">)]</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">verilog_outer_def_as_list_io</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;wire&quot;</span><span class="p">,</span>
                <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">width</span><span class="o">==</span><span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">:0]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">width</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name_until_component</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_iosig_type_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">verilog_def</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iosig_type_prefix</span><span class="p">,</span><span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">width</span><span class="o">==</span><span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">:0]&#39;</span> <span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">width</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">name_before_component</span><span class="p">)]</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">verilog_def_as_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_iosig_type_prefix</span><span class="p">,</span>
                <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">width</span><span class="o">==</span><span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">:0]&#39;</span> <span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">width</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name_before_component</span><span class="p">]</span></div>





<div class="viewcode-block" id="Input"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Input">[文档]</a><span class="k">class</span> <span class="nc">Input</span><span class="p">(</span><span class="n">IOSig</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Input is used to declare an input port for Component in UHDL.</span>

<span class="sd">    Input needs a UHDL constant as a template to declare its type. </span>
<span class="sd">    Its type will be consistent with the constants they use as templates.</span>

<span class="sd">    A typical example is</span>

<span class="sd">            Input(UInt(32))</span>

<span class="sd">    The type of Input in this example will be consistent with UInt(32), </span>
<span class="sd">    that is, it is a 32-bit unsigned integer.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1">#@property</span>
    <span class="c1">#def is_lvalue(self):</span>
    <span class="c1">#    pass</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lstring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_until_component</span> <span class="c1">#self.__name</span>

    <span class="c1">#@property</span>
<div class="viewcode-block" id="Input.rstring"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Input.rstring">[文档]</a>    <span class="k">def</span> <span class="nf">rstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lvalue</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_before_component</span> <span class="c1">#self.__name</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_iosig_type_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;input&#39;</span>

<div class="viewcode-block" id="Input.reverse"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Input.reverse">[文档]</a>    <span class="k">def</span> <span class="nf">reverse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Output</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span></div>

<div class="viewcode-block" id="Input.template"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Input.template">[文档]</a>    <span class="k">def</span> <span class="nf">template</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Input</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span></div></div>






<div class="viewcode-block" id="Output"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Output">[文档]</a><span class="k">class</span> <span class="nc">Output</span><span class="p">(</span><span class="n">IOSig</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Output is used to declare an output port for Component in UHDL.</span>

<span class="sd">    Output needs a UHDL constant as a template to declare its type. </span>
<span class="sd">    Its type will be consistent with the constants they use as templates.</span>

<span class="sd">    A typical example is</span>

<span class="sd">            Output(UInt(32))</span>

<span class="sd">    The type of Output in this example will be consistent with UInt(32), </span>
<span class="sd">    that is, it is a 32-bit unsigned integer.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1">#@property</span>
    <span class="c1">#def is_lvalue(self):</span>
    <span class="c1">#    pass</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lstring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_before_component</span> <span class="c1">#self.__name</span>

    <span class="c1">#@property</span>
<div class="viewcode-block" id="Output.rstring"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Output.rstring">[文档]</a>    <span class="k">def</span> <span class="nf">rstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lvalue</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">lvalue</span><span class="o">.</span><span class="n">father_until_component</span><span class="p">()</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">father_until_component</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_before_component</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_until_component</span> <span class="c1">#self.__name</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_iosig_type_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;output reg&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_need_always</span> <span class="k">else</span> <span class="s1">&#39;output&#39;</span>

<div class="viewcode-block" id="Output.reverse"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Output.reverse">[文档]</a>    <span class="k">def</span> <span class="nf">reverse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Input</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span></div>

<div class="viewcode-block" id="Output.template"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Output.template">[文档]</a>    <span class="k">def</span> <span class="nf">template</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Output</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span></div></div>




<div class="viewcode-block" id="Inout"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Inout">[文档]</a><span class="k">class</span> <span class="nc">Inout</span><span class="p">(</span><span class="n">IOSig</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_iosig_type_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;inout&#39;</span>

<div class="viewcode-block" id="Inout.reverse"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Inout.reverse">[文档]</a>    <span class="k">def</span> <span class="nf">reverse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Inout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span></div>

<div class="viewcode-block" id="Inout.template"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Inout.template">[文档]</a>    <span class="k">def</span> <span class="nf">template</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Inout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span></div></div>






<div class="viewcode-block" id="GroupVar"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.GroupVar">[文档]</a><span class="k">class</span> <span class="nc">GroupVar</span><span class="p">(</span><span class="n">Variable</span><span class="p">):</span>

<div class="viewcode-block" id="GroupVar.exclude"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.GroupVar.exclude">[文档]</a>    <span class="k">def</span> <span class="nf">exclude</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">str_list</span><span class="p">):</span>
        <span class="k">pass</span></div></div>


<div class="viewcode-block" id="IOGroup"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.IOGroup">[文档]</a><span class="k">class</span> <span class="nc">IOGroup</span><span class="p">(</span><span class="n">GroupVar</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1">#super(IOGroup,self).__init__()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rvalue</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">io_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">IOSig</span><span class="p">)])</span>

    <span class="c1"># += as circuit assignment</span>
    <span class="k">def</span> <span class="fm">__iadd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">rvalue</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rvalue</span><span class="p">,</span><span class="n">IOGroup</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ArithmeticError</span><span class="p">(</span><span class="s1">&#39;A IOGroup expect assigned by a IOGroup.&#39;</span><span class="p">)</span>
        <span class="c1"># elif self.attribute != rvalue.attribute:</span>
        <span class="c1">#     raise ArithmeticError(&#39;Left value attribute/Right value attribute mismatch.&#39;)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">iol</span><span class="p">,</span><span class="n">ior</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">io_list</span><span class="p">,</span><span class="n">rvalue</span><span class="o">.</span><span class="n">io_list</span><span class="p">):</span>
                <span class="c1">#print(iol,ior)</span>
                <span class="c1">#print(iol,ior)</span>
                <span class="c1">#print(iol.width,ior.width)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iol</span><span class="p">,</span><span class="n">Input</span><span class="p">):</span>
                    <span class="n">ior</span> <span class="o">+=</span> <span class="n">iol</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">iol</span> <span class="o">+=</span> <span class="n">ior</span>
            <span class="c1">#print(&#39;%s get rvalue %s&#39;  %(self,rvalue))</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;_rvalue&#39;</span><span class="p">,</span><span class="n">rvalue</span><span class="p">)</span>
            <span class="c1">#self.__rvalue = rvalue</span>
        <span class="k">return</span> <span class="bp">self</span>

<div class="viewcode-block" id="IOGroup.exclude"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.IOGroup.exclude">[文档]</a>    <span class="k">def</span> <span class="nf">exclude</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="nb">delattr</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="nb">delattr</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">verilog_assignment</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span><span class="n">concat</span><span class="p">,[</span><span class="n">x</span><span class="o">.</span><span class="n">verilog_assignment</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">io_list</span><span class="p">],[])</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">verilog_def</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span><span class="n">concat</span><span class="p">,[</span><span class="n">x</span><span class="o">.</span><span class="n">verilog_def</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">io_list</span><span class="p">],[])</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">verilog_outer_def</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span><span class="n">concat</span><span class="p">,[</span><span class="n">x</span><span class="o">.</span><span class="n">verilog_outer_def</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">io_list</span><span class="p">],[])</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">verilog_inst</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span><span class="n">concat</span><span class="p">,[</span><span class="n">x</span><span class="o">.</span><span class="n">verilog_inst</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">io_list</span><span class="p">],[])</span>

<div class="viewcode-block" id="IOGroup.reverse"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.IOGroup.reverse">[文档]</a>    <span class="k">def</span> <span class="nf">reverse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">reverse</span> <span class="o">=</span> <span class="n">IOGroup</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">io_list</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">reverse</span><span class="p">,</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">i</span><span class="o">.</span><span class="n">reverse</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">reverse</span></div></div>






<div class="viewcode-block" id="Expression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Expression">[文档]</a><span class="k">class</span> <span class="nc">Expression</span><span class="p">(</span><span class="n">Value</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>


<span class="c1">################################################################################################################</span>
<span class="c1">#</span>
<span class="c1">#   Constant Expression</span>
<span class="c1">#</span>
<span class="c1">################################################################################################################</span>

<div class="viewcode-block" id="Constant"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Constant">[文档]</a><span class="k">class</span> <span class="nc">Constant</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="AnyConstant"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.AnyConstant">[文档]</a><span class="k">class</span> <span class="nc">AnyConstant</span><span class="p">(</span><span class="n">Constant</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">any_val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_any_val</span> <span class="o">=</span> <span class="n">any_val</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">template</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

<div class="viewcode-block" id="AnyConstant.rstring"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.AnyConstant.rstring">[文档]</a>    <span class="k">def</span> <span class="nf">rstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lvalue</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_any_val</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lstring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>


    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;AnyConstant </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_any_val</span></div>





<div class="viewcode-block" id="Bits"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Bits">[文档]</a><span class="k">class</span> <span class="nc">Bits</span><span class="p">(</span><span class="n">Constant</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">width_or_string</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1">#super(Bits,self).__init__(self)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">width_or_string</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__width</span> <span class="o">=</span> <span class="n">width_or_string</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__value</span> <span class="o">=</span> <span class="n">value</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__is_string</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">width_or_string</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__width</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">__value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slove_wid_val_from_str</span><span class="p">(</span><span class="n">width_or_string</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__is_string</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#raise Exception(&#39;Input is not String or Int&#39;)</span>
            <span class="k">raise</span> <span class="n">ErrConstInWrong</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">width_or_string</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__value</span> <span class="o">&gt;</span> <span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">__width</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ErrBitsValOverflow</span><span class="p">(</span><span class="s1">&#39;The input bit width </span><span class="si">%s</span><span class="s1"> of </span><span class="si">%s</span><span class="s1"> does not match the value </span><span class="si">%s</span><span class="s1">, and the value is greater than the upper limit.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__width</span><span class="p">,</span><span class="n">GetClsNameFromObj</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">__value</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_slove_wid_val_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">string</span><span class="p">):</span>
        <span class="n">mb</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;([0-9]+)(</span><span class="se">\&#39;</span><span class="s1">[bB])([01_]+)&#39;</span>        <span class="p">,</span><span class="n">string</span><span class="p">)</span>
        <span class="n">md</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;([0-9]+)(</span><span class="se">\&#39;</span><span class="s1">[dD])([0-9_]+)&#39;</span>       <span class="p">,</span><span class="n">string</span><span class="p">)</span>
        <span class="n">mh</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;([0-9]+)(</span><span class="se">\&#39;</span><span class="s1">[hH])([0-9a-fA-F_]+)&#39;</span> <span class="p">,</span><span class="n">string</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">mb</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mb</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mb</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">md</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">md</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">md</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">),</span><span class="mi">10</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">mh</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mh</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mh</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">),</span><span class="mi">16</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ErrBitsInvalidStr</span><span class="p">(</span><span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot; is not a legal string and cannot be decoded as bit width and value&#39;</span> <span class="o">%</span> <span class="n">string</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">width</span><span class="p">,</span><span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__width</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">template</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="c1">#@property</span>
    <span class="c1">#def string(self):</span>
    <span class="c1">#    return &#39;%s\&#39;b%s&#39; % (self.__width,bin(self.__value).replace(&#39;0b&#39;,&#39;&#39;) )           #pass</span>

    <span class="c1">#@property</span>
<div class="viewcode-block" id="Bits.rstring"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Bits.rstring">[文档]</a>    <span class="k">def</span> <span class="nf">rstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lvalue</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">b</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__width</span><span class="p">,</span><span class="nb">bin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__value</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;0b&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">)</span>           <span class="c1">#pass</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lstring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">width</span> <span class="k">else</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Bits(</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">) with py ID </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>






<div class="viewcode-block" id="UInt"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.UInt">[文档]</a><span class="k">class</span> <span class="nc">UInt</span><span class="p">(</span><span class="n">Bits</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    UInt is a constant type in UHDL.It is an unsigned integer.There are two ways to initialize UInt, the first required parameter is:</span>
<span class="sd">    </span>
<span class="sd">        int W - 0&lt;W</span>
<span class="sd">        int V - 0&lt;=V&lt;(2^W-1)   (default value is 0)</span>
<span class="sd">    </span>
<span class="sd">    A typical example is</span>

<span class="sd">        UInt(4,5)</span>

<span class="sd">    It stands for</span>
<span class="sd">        </span>
<span class="sd">        4&#39;b0101</span>

<span class="sd">    The second required parameter is:</span>

<span class="sd">        string S - S must be a valid verilog value expression</span>

<span class="sd">    A typical example is</span>

<span class="sd">        UInt(&quot;4&#39;b0101&quot;)</span>

<span class="sd">    It stands for</span>

<span class="sd">        4&#39;b0101</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;UInt(</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">) with py ID </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>



<div class="viewcode-block" id="SInt"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.SInt">[文档]</a><span class="k">class</span> <span class="nc">SInt</span><span class="p">(</span><span class="n">Bits</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    SInt is a constant type in UHDL.It is a signed integer.There are two ways to initialize SInt, the first required parameter is:</span>
<span class="sd">    </span>
<span class="sd">        int W - 0&lt;W</span>
<span class="sd">        int V - (-2^(W-1))&lt;V&lt;(2^(W-1)-1)   (default value is 0)</span>
<span class="sd">    </span>
<span class="sd">    A typical example is</span>

<span class="sd">        SInt(4,-3)</span>

<span class="sd">    It stands for</span>
<span class="sd">        </span>
<span class="sd">        4&#39;b1101</span>

<span class="sd">    The second required parameter is:</span>

<span class="sd">        string S - S must be a valid verilog value expression</span>

<span class="sd">    A typical example is</span>

<span class="sd">        SInt(&quot;4&#39;b1101&quot;)</span>

<span class="sd">    It stands for</span>

<span class="sd">        4&#39;b1101</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1">#SInt的数值计算需要重新定义一下，Bits的只是对应了UInt</span>
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;SInt(</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">) with py ID </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>

<div class="viewcode-block" id="Parameter"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Parameter">[文档]</a><span class="k">class</span> <span class="nc">Parameter</span><span class="p">(</span><span class="n">SingleVar</span><span class="p">):</span>

    <span class="c1">#@property</span>
    <span class="c1">#def string(self):</span>
    <span class="c1">#    return self.name</span>

    <span class="c1">#@property</span>
<div class="viewcode-block" id="Parameter.rstring"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.Parameter.rstring">[文档]</a>    <span class="k">def</span> <span class="nf">rstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lvalue</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lstring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">verilog_assignment</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;_rvalue&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rvalue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;.</span><span class="si">%s</span><span class="s1">(</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lstring</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_template</span><span class="o">.</span><span class="n">rstring</span><span class="p">(</span><span class="bp">self</span><span class="p">))]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;.</span><span class="si">%s</span><span class="s1">(</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lstring</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_rvalue</span><span class="o">.</span><span class="n">rstring</span><span class="p">(</span><span class="bp">self</span><span class="p">))]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">verilog_def</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;parameter </span><span class="si">%s</span><span class="s1"> = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lstring</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">rstring</span><span class="p">(</span><span class="bp">self</span><span class="p">))]</span></div>


    <span class="c1"># @property</span>
    <span class="c1"># def width(self):</span>
    <span class="c1">#     return self.__width</span>
<span class="c1"># </span>
    <span class="c1"># @property</span>
    <span class="c1"># def string(self):</span>
    <span class="c1">#     return self.name_before_component #self.__name</span>
<span class="c1"># </span>
    <span class="c1"># @property</span>
    <span class="c1"># def attribute(self):</span>
    <span class="c1">#     return self.__width</span>


    <span class="c1">#@attribute.setter</span>
    <span class="c1">#def atrribute(self,value):</span>
    <span class="c1">#    self.__attribute = value</span>



<span class="c1">################################################################################################################</span>
<span class="c1">#</span>
<span class="c1">#   AlwaysCombExpression</span>
<span class="c1">#</span>
<span class="c1">################################################################################################################</span>

<div class="viewcode-block" id="AlwaysCombExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.AlwaysCombExpression">[文档]</a><span class="k">class</span> <span class="nc">AlwaysCombExpression</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>
    <span class="k">pass</span>   </div>


<div class="viewcode-block" id="CaseExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.CaseExpression">[文档]</a><span class="k">class</span> <span class="nc">CaseExpression</span><span class="p">(</span><span class="n">AlwaysCombExpression</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">select</span><span class="p">,</span><span class="n">case_pair</span><span class="o">=</span><span class="p">[],</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__select</span>    <span class="o">=</span> <span class="n">select</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__case_pair</span> <span class="o">=</span> <span class="n">case_pair</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__default</span>   <span class="o">=</span> <span class="n">default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__attr</span>      <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">check_rvalue</span><span class="p">(</span><span class="n">select</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_rvalue</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__attr</span> <span class="o">=</span> <span class="n">default</span><span class="o">.</span><span class="n">attribute</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">case_pair</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_rvalue</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_rvalue</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">attribute</span> <span class="o">!=</span> <span class="n">select</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>                         <span class="n">ErrAttrMismatch</span><span class="p">(</span><span class="s1">&#39;All key in case_pair must have the same attribute select signal.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">__select</span><span class="p">,</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__case_key</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__attr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">v</span><span class="o">.</span><span class="n">attribute</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__attr</span><span class="p">:</span>  
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__default</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ErrAttrMismatch</span><span class="p">(</span><span class="s1">&#39;All value in case_pair must have same attribute.&#39;</span><span class="p">,</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__case_value</span><span class="p">)</span>
                <span class="k">else</span>                     <span class="p">:</span> <span class="n">ErrAttrMismatch</span><span class="p">(</span><span class="s1">&#39;All value in case_pair must have same attribute.&#39;</span><span class="p">,</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__case_value</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">__default</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__attr</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">attribute</span> 

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">__case_key</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__case_pair</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">__case_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__case_value</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__attr</span>

<div class="viewcode-block" id="CaseExpression.bstring"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.CaseExpression.bstring">[文档]</a>    <span class="k">def</span> <span class="nf">bstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lvalue</span><span class="p">,</span> <span class="n">assign_method</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">str_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;case(</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">__select</span><span class="o">.</span><span class="n">rstring</span><span class="p">(</span><span class="n">lvalue</span><span class="p">)]</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__case_pair</span><span class="p">:</span>
            <span class="n">logic_block</span>     <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">bstring</span><span class="p">(</span><span class="n">lstring</span><span class="p">,</span><span class="n">assign_method</span><span class="p">)</span>
            <span class="n">logic_block</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">rstring</span><span class="p">(</span><span class="n">lvalue</span><span class="p">),</span><span class="n">logic_block</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">logic_block</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;    </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">logic_block</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
            <span class="n">str_list</span> <span class="o">+=</span> <span class="n">logic_block</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__default</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logic_block</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__default</span><span class="o">.</span><span class="n">bstring</span><span class="p">(</span><span class="n">lstring</span><span class="p">,</span><span class="n">assign_method</span><span class="p">)</span>
            <span class="n">logic_block</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="o">=</span> <span class="s1">&#39;default : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">logic_block</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">logic_block</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;    </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">logic_block</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
            <span class="n">str_list</span> <span class="o">+=</span> <span class="n">logic_block</span>

        <span class="n">str_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;endcase&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;begin&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="s2">&quot;    &quot;</span><span class="o">+</span><span class="n">x</span><span class="p">,</span><span class="n">str_list</span><span class="p">))</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span></div></div>





<div class="viewcode-block" id="WhenExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.WhenExpression">[文档]</a><span class="k">class</span> <span class="nc">WhenExpression</span><span class="p">(</span><span class="n">AlwaysCombExpression</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_condition_list</span>    <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_action_list</span>       <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_otherwise_action</span>  <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_attribute</span>         <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_next_is_when</span>      <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_otherwise</span>     <span class="o">=</span> <span class="kc">False</span>
    
<div class="viewcode-block" id="WhenExpression.when"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.WhenExpression.when">[文档]</a>    <span class="k">def</span> <span class="nf">when</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">:</span> <span class="n">Value</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        When is used to construct a complex selection circuit, and the input of when is </span>
<span class="sd">            </span>
<span class="sd">            rhs I - UInt(1)</span>
<span class="sd">            </span>
<span class="sd">        The return value of when will only be calculated after the when selection circuit is completed. </span>
<span class="sd">        When the when selection circuit uses multiple &quot;when&quot;, &quot;then&quot;, &quot;otherwise&quot; completions, </span>
<span class="sd">        the attribute of its return value O will be the same as the input specified by &quot;then&quot; and &quot;otherwise&quot;.</span>
<span class="sd">        </span>
<span class="sd">        A typical example is:</span>

<span class="sd">            O += when(A).then(Ares).when(B).then(Bres).otherwise(DFTres)</span>

<span class="sd">        The corresponding behavior of this selection circuit example it expresses is </span>

<span class="sd">            if(A)       O = Ares</span>
<span class="sd">            else if(B)  O = Bres</span>
<span class="sd">            else        O = DFTres</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># operate struct check</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_is_when</span> <span class="o">==</span> <span class="kc">False</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">ErrWhenExpOperateWrong</span><span class="p">(</span><span class="s1">&#39;A &quot;when&quot; has been added to the when expression.At this time, you can only use &quot;then&quot; complete the &quot;when-then&quot; pairing,but get a &quot;otherwise&quot;.&#39;</span><span class="p">)</span>
        
        <span class="c1"># input value check</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_rvalue</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">val</span><span class="o">.</span><span class="n">attribute</span> <span class="o">!=</span> <span class="n">UInt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>    <span class="p">:</span> <span class="k">raise</span> <span class="n">ErrLogicSigAttrWrong</span><span class="p">(</span><span class="s1">&#39;&quot;when&quot; need a boolean rhs as input.&#39;</span><span class="p">,</span><span class="n">Value</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_next_is_when</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_condition_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

    <span class="n">When</span> <span class="o">=</span> <span class="n">when</span>

<div class="viewcode-block" id="WhenExpression.then"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.WhenExpression.then">[文档]</a>    <span class="k">def</span> <span class="nf">then</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">:</span><span class="n">Value</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Then is used to continue filling information into the complex selection circuit constructed by &quot;When&quot; and &quot;EmptyWhen&quot;. </span>
<span class="sd">        The input of Then is </span>
<span class="sd">            </span>
<span class="sd">            rhs I - UInt/SInt(i)</span>
<span class="sd">            </span>
<span class="sd">        which represents the output result of the selection circuit when the condition specified by &quot;When&quot; before &quot;Then&quot; is satisfied. </span>
<span class="sd">        </span>
<span class="sd">        All output results specified by &quot;Then&quot; and &quot;Otherwise&quot; must have the same attributes.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># operate struck check</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_is_when</span> <span class="o">==</span> <span class="kc">True</span>      <span class="p">:</span> <span class="k">raise</span> <span class="n">ErrWhenExpOperateWrong</span><span class="p">(</span><span class="s1">&#39;In when expressions, &quot;then&quot; can only follow &quot;when&quot;.&#39;</span><span class="p">)</span>
        <span class="c1"># input value check</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_rvalue</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute</span> <span class="o">==</span> <span class="kc">None</span>         <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">attribute</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute</span> <span class="o">!=</span> <span class="n">val</span><span class="o">.</span><span class="n">attribute</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">ErrAttrMismatch</span><span class="p">(</span><span class="s1">&#39;In a When expression, all variables declared by &quot;then&quot; and &quot;otherwise&quot; must have the same attribute.&#39;</span><span class="p">,</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_action_list</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_otherwise_action</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_next_is_when</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_action_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

    <span class="n">Then</span> <span class="o">=</span> <span class="n">then</span>
    
<div class="viewcode-block" id="WhenExpression.otherwise"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.WhenExpression.otherwise">[文档]</a>    <span class="k">def</span> <span class="nf">otherwise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">:</span> <span class="n">Value</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Otherwise is used to continue filling information into the complex selection circuit constructed by &quot;When&quot; and &quot;EmptyWhen&quot;. </span>
<span class="sd">        The input of Otherwise is </span>
<span class="sd">            </span>
<span class="sd">            rhs I - UInt/SInt(i)</span>
<span class="sd">            </span>
<span class="sd">        which represents the default result selected by the selection circuit when all the conditions specified by &quot;When&quot; are not established.</span>
<span class="sd">        </span>
<span class="sd">        All output results specified by &quot;Then&quot; and &quot;Otherwise&quot; must have the same attributes.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># operate struct check</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_otherwise</span> <span class="o">==</span> <span class="kc">True</span>      <span class="p">:</span> <span class="k">raise</span> <span class="n">ErrWhenExpOperateWrong</span><span class="p">(</span><span class="s1">&#39;A when expression can only have one &quot;otherwise&quot;.&#39;</span><span class="p">)</span>
        <span class="c1"># input value check</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_rvalue</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute</span> <span class="o">==</span> <span class="kc">None</span>          <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">attribute</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute</span> <span class="o">!=</span> <span class="n">val</span><span class="o">.</span><span class="n">attribute</span>  <span class="p">:</span> <span class="k">raise</span> <span class="n">ErrAttrMismatch</span><span class="p">(</span><span class="s1">&#39;In a When expression, all variables declared by &quot;then&quot; and &quot;otherwise&quot; must have the same attribute.&#39;</span><span class="p">,</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_action_list</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_otherwise_action</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_has_otherwise</span>    <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_otherwise_action</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="bp">self</span></div>

    <span class="n">Ohterwise</span> <span class="o">=</span> <span class="n">otherwise</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Unprocess Error.expression used before constructed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute</span>

<div class="viewcode-block" id="WhenExpression.bstring"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.WhenExpression.bstring">[文档]</a>    <span class="k">def</span> <span class="nf">bstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">lvalue</span><span class="p">,</span><span class="n">assign_method</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">str_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,(</span><span class="n">condition</span><span class="p">,</span><span class="n">action</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_condition_list</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_action_list</span><span class="p">)):</span>
            <span class="n">if_block</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">bstring</span><span class="p">(</span><span class="n">lvalue</span><span class="p">,</span><span class="n">assign_method</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">index</span><span class="o">==</span><span class="mi">0</span> <span class="p">:</span> <span class="n">if_block</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;if(</span><span class="si">%s</span><span class="s2">) </span><span class="si">%s</span><span class="s2">&quot;</span>      <span class="o">%</span><span class="p">(</span><span class="n">condition</span><span class="o">.</span><span class="n">rstring</span><span class="p">(</span><span class="n">lvalue</span><span class="p">),</span><span class="n">if_block</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span>        <span class="p">:</span> <span class="n">if_block</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;else if(</span><span class="si">%s</span><span class="s2">) </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">condition</span><span class="o">.</span><span class="n">rstring</span><span class="p">(</span><span class="n">lvalue</span><span class="p">),</span><span class="n">if_block</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">str_list</span> <span class="o">+=</span> <span class="n">if_block</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_otherwise</span><span class="p">:</span>
            <span class="n">if_block</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_otherwise_action</span><span class="o">.</span><span class="n">bstring</span><span class="p">(</span><span class="n">lvalue</span><span class="p">,</span><span class="n">assign_method</span><span class="p">)</span>
            <span class="n">if_block</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;else </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">if_block</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">str_list</span> <span class="o">+=</span> <span class="n">if_block</span>

        <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;begin&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="s2">&quot;    &quot;</span><span class="o">+</span><span class="n">x</span><span class="p">,</span><span class="n">str_list</span><span class="p">))</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span></div></div>




<div class="viewcode-block" id="CutExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.CutExpression">[文档]</a><span class="k">class</span> <span class="nc">CutExpression</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">op</span><span class="p">:</span><span class="n">Value</span><span class="p">,</span><span class="n">hbound</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span><span class="n">lbound</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">check_rvalue</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">op</span>     <span class="o">=</span> <span class="n">op</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hbound</span> <span class="o">=</span> <span class="n">hbound</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbound</span> <span class="o">=</span> <span class="n">lbound</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hbound</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ErrCutExpSliceInvalid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;hbound </span><span class="si">%s</span><span class="s1"> should be int.&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">hbound</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lbound</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ErrCutExpSliceInvalid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;lbound </span><span class="si">%s</span><span class="s1"> should be int.&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lbound</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hbound</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ErrCutExpSliceInvalid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;hbound </span><span class="si">%s</span><span class="s1"> must be greater than or equal to 0&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">hbound</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lbound</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ErrCutExpSliceInvalid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;lbound </span><span class="si">%s</span><span class="s1"> must be greater than or equal to 0&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lbound</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hbound</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">lbound</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ErrCutExpSliceInvalid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;hbound </span><span class="si">%s</span><span class="s1"> must be greater than or equal to lbound </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hbound</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">lbound</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">hbound</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ErrCutExpSliceInvalid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;hbound </span><span class="si">%s</span><span class="s1"> exceeds the variable range of </span><span class="si">%s</span><span class="s1">[</span><span class="si">%s</span><span class="s1">:0]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hbound</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">op</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">width</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Cut([*:*])&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="o">.</span><span class="n">attribute</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">hbound</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">lbound</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1">#@property</span>
    <span class="c1">#def string(self) -&gt; str:</span>
    <span class="c1">#    return self.op.string + &#39;[%s:%s]&#39; % ( self.hbound, self.lbound )</span>
    
    <span class="c1">#@property</span>
<div class="viewcode-block" id="CutExpression.rstring"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.CutExpression.rstring">[文档]</a>    <span class="k">def</span> <span class="nf">rstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lvalue</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="o">.</span><span class="n">rstring</span><span class="p">(</span><span class="n">lvalue</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">:</span><span class="si">%s</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">hbound</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lbound</span> <span class="p">)</span></div></div>






<div class="viewcode-block" id="FanoutExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.FanoutExpression">[文档]</a><span class="k">class</span> <span class="nc">FanoutExpression</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">:</span><span class="n">Value</span><span class="p">,</span> <span class="n">fanout</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_op</span> <span class="o">=</span> <span class="n">op</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fanout</span> <span class="o">=</span> <span class="n">fanout</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_op</span><span class="o">.</span><span class="n">attribute</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">_op</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fanout</span><span class="p">)</span>

    <span class="c1">#@property</span>
    <span class="c1">#def string(self) -&gt; str:</span>
    <span class="c1">#    return &#39;(%s{%s})&#39; % (self._fanout,self._op.string)</span>

    <span class="c1">#@property</span>
<div class="viewcode-block" id="FanoutExpression.rstring"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.FanoutExpression.rstring">[文档]</a>    <span class="k">def</span> <span class="nf">rstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lvalue</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;({</span><span class="si">%s</span><span class="s1">{</span><span class="si">%s</span><span class="s1">}})&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fanout</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_op</span><span class="o">.</span><span class="n">rstring</span><span class="p">(</span><span class="n">lvalue</span><span class="p">))</span></div></div>





<span class="c1">################################################################################################################</span>
<span class="c1">#</span>
<span class="c1">#   List Op Expression</span>
<span class="c1">#</span>
<span class="c1">################################################################################################################</span>


<div class="viewcode-block" id="ListExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.ListExpression">[文档]</a><span class="k">class</span> <span class="nc">ListExpression</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">op_list</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">op_list</span> <span class="o">=</span> <span class="n">op_list</span>
        <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">op_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_rvalue</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>

    <span class="c1">#@property</span>
    <span class="c1">#def string(self) -&gt; str:</span>
    <span class="c1">#    tmp_op_str = &#39; %s &#39;%self.op_str</span>
    <span class="c1">#    return &#39;(%s)&#39; %  tmp_op_str.join([op.string for op in self.op_list])</span>
    
    <span class="c1">#@property</span>
<div class="viewcode-block" id="ListExpression.rstring"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.ListExpression.rstring">[文档]</a>    <span class="k">def</span> <span class="nf">rstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lvalue</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">tmp_op_str</span> <span class="o">=</span> <span class="s1">&#39; </span><span class="si">%s</span><span class="s1"> &#39;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">op_str</span>
        <span class="k">return</span> <span class="s1">&#39;(</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span>  <span class="n">tmp_op_str</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">op</span><span class="o">.</span><span class="n">rstring</span><span class="p">(</span><span class="n">lvalue</span><span class="p">)</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">op_list</span><span class="p">])</span></div></div>


<div class="viewcode-block" id="MultiListExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.MultiListExpression">[文档]</a><span class="k">class</span> <span class="nc">MultiListExpression</span><span class="p">(</span><span class="n">ListExpression</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">op_list</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">op_list</span><span class="p">)</span>
        <span class="c1"># 1 param still work.</span>
        <span class="c1">#if len(op_list) &lt; 2:    raise ErrListExpNeedMultiOp(&#39;&#39;,op_list)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">UInt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="MultiSameListExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.MultiSameListExpression">[文档]</a><span class="k">class</span> <span class="nc">MultiSameListExpression</span><span class="p">(</span><span class="n">MultiListExpression</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">op_list</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">op_list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">op_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">op_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span> <span class="o">!=</span> <span class="n">op</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span><span class="k">raise</span> <span class="n">ErrAttrMismatch</span><span class="p">(</span><span class="s1">&#39;Can not &quot;</span><span class="si">%s</span><span class="s1">&quot; Values with different attributes.&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">op_name</span><span class="p">,</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">op_list</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">op_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span></div>

<span class="c1">################################################################################################################</span>
<span class="c1">#</span>
<span class="c1">#   List Op Expression</span>
<span class="c1">#       Same List Expression</span>
<span class="c1">################################################################################################################</span>


<div class="viewcode-block" id="AndListExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.AndListExpression">[文档]</a><span class="k">class</span> <span class="nc">AndListExpression</span><span class="p">(</span><span class="n">MultiListExpression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;AndList(&amp;&amp;)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&amp;&amp;&#39;</span></div>




<div class="viewcode-block" id="OrListExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.OrListExpression">[文档]</a><span class="k">class</span> <span class="nc">OrListExpression</span><span class="p">(</span><span class="n">MultiListExpression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;OrList(||)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;||&#39;</span></div>





<div class="viewcode-block" id="BitAndListExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.BitAndListExpression">[文档]</a><span class="k">class</span> <span class="nc">BitAndListExpression</span><span class="p">(</span><span class="n">MultiSameListExpression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;BitAndList(&amp;)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&amp;&#39;</span></div>




<div class="viewcode-block" id="BitOrListExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.BitOrListExpression">[文档]</a><span class="k">class</span> <span class="nc">BitOrListExpression</span><span class="p">(</span><span class="n">MultiSameListExpression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;BitOrList(|)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;|&#39;</span></div>




<div class="viewcode-block" id="BitXorListExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.BitXorListExpression">[文档]</a><span class="k">class</span> <span class="nc">BitXorListExpression</span><span class="p">(</span><span class="n">MultiSameListExpression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;BitXorList(^)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;^&#39;</span></div>




<div class="viewcode-block" id="BitXnorListExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.BitXnorListExpression">[文档]</a><span class="k">class</span> <span class="nc">BitXnorListExpression</span><span class="p">(</span><span class="n">MultiSameListExpression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;BitXnorList(^~)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;^~&#39;</span></div>




<div class="viewcode-block" id="CombineExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.CombineExpression">[文档]</a><span class="k">class</span> <span class="nc">CombineExpression</span><span class="p">(</span><span class="n">ListExpression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Combine({*,*})&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">op_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span><span class="p">)(</span><span class="nb">sum</span><span class="p">([</span><span class="n">op</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">width</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">op_list</span><span class="p">]))</span>

    <span class="c1">#@property</span>
    <span class="c1">#def string(self) -&gt; str:</span>
    <span class="c1">#    return &#39;{%s}&#39; % &#39;, &#39;.join([op.string for op in self.op_list])</span>
    
    <span class="c1">#@property</span>
<div class="viewcode-block" id="CombineExpression.rstring"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.CombineExpression.rstring">[文档]</a>    <span class="k">def</span> <span class="nf">rstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lvalue</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;{</span><span class="si">%s</span><span class="s1">}&#39;</span> <span class="o">%</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">op</span><span class="o">.</span><span class="n">rstring</span><span class="p">(</span><span class="n">lvalue</span><span class="p">)</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">op_list</span><span class="p">])</span></div></div>




<span class="c1">################################################################################################################</span>
<span class="c1">#</span>
<span class="c1">#   One Op Expression</span>
<span class="c1">#</span>
<span class="c1">################################################################################################################</span>

<div class="viewcode-block" id="OneOpExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.OneOpExpression">[文档]</a><span class="k">class</span> <span class="nc">OneOpExpression</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">op</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_op</span> <span class="o">=</span> <span class="n">op</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_rvalue</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>

    <span class="c1">#@property</span>
    <span class="c1">#def string(self) -&gt; str:</span>
    <span class="c1">#    return &#39;(%s%s)&#39; % (self.op_str,self._op.string)</span>

    <span class="c1">#@property</span>
<div class="viewcode-block" id="OneOpExpression.rstring"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.OneOpExpression.rstring">[文档]</a>    <span class="k">def</span> <span class="nf">rstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lvalue</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;(</span><span class="si">%s%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">op_str</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_op</span><span class="o">.</span><span class="n">rstring</span><span class="p">(</span><span class="n">lvalue</span><span class="p">))</span></div></div>

<div class="viewcode-block" id="OneOpU1Expression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.OneOpU1Expression">[文档]</a><span class="k">class</span> <span class="nc">OneOpU1Expression</span><span class="p">(</span><span class="n">OneOpExpression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">UInt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="OneOpBitExpressionTest"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.OneOpBitExpressionTest">[文档]</a><span class="k">class</span> <span class="nc">OneOpBitExpressionTest</span><span class="p">(</span><span class="n">OneOpExpression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_op</span><span class="o">.</span><span class="n">attribute</span></div>





<div class="viewcode-block" id="InverseExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.InverseExpression">[文档]</a><span class="k">class</span> <span class="nc">InverseExpression</span><span class="p">(</span><span class="n">OneOpBitExpressionTest</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Inverse(~)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;~&#39;</span></div>



<div class="viewcode-block" id="NotExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.NotExpression">[文档]</a><span class="k">class</span> <span class="nc">NotExpression</span><span class="p">(</span><span class="n">OneOpU1Expression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Not(!)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;!&#39;</span></div>




<div class="viewcode-block" id="SelfOrExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.SelfOrExpression">[文档]</a><span class="k">class</span> <span class="nc">SelfOrExpression</span><span class="p">(</span><span class="n">OneOpU1Expression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;SelfOr(|)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;|&#39;</span></div>




<div class="viewcode-block" id="SelfAndExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.SelfAndExpression">[文档]</a><span class="k">class</span> <span class="nc">SelfAndExpression</span><span class="p">(</span><span class="n">OneOpU1Expression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;SelfAnd(&amp;)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&amp;&#39;</span></div>



<div class="viewcode-block" id="SelfXorExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.SelfXorExpression">[文档]</a><span class="k">class</span> <span class="nc">SelfXorExpression</span><span class="p">(</span><span class="n">OneOpU1Expression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;SelfXor(^)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;^&#39;</span></div>



<div class="viewcode-block" id="SelfXnorExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.SelfXnorExpression">[文档]</a><span class="k">class</span> <span class="nc">SelfXnorExpression</span><span class="p">(</span><span class="n">OneOpU1Expression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;SelfXnor(^~)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;^~&#39;</span></div>



<span class="c1">################################################################################################################</span>
<span class="c1">#</span>
<span class="c1">#   Two Ops Expression</span>
<span class="c1">#</span>
<span class="c1">################################################################################################################</span>

<div class="viewcode-block" id="TwoOpExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.TwoOpExpression">[文档]</a><span class="k">class</span> <span class="nc">TwoOpExpression</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">opL</span><span class="p">:</span><span class="n">Value</span><span class="p">,</span><span class="n">opR</span><span class="p">:</span><span class="n">Value</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_rvalue</span><span class="p">(</span><span class="n">opL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_rvalue</span><span class="p">(</span><span class="n">opR</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opL</span> <span class="o">=</span> <span class="n">opL</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opR</span> <span class="o">=</span> <span class="n">opR</span>

    <span class="c1">#@property</span>
    <span class="c1">#def string(self) -&gt; str:</span>
    <span class="c1">#    return &#39;(%s %s %s)&#39;  % (self.opL.string ,self.op_str,self.opR.string)</span>
    
    <span class="c1">#@property</span>
<div class="viewcode-block" id="TwoOpExpression.rstring"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.TwoOpExpression.rstring">[文档]</a>    <span class="k">def</span> <span class="nf">rstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lvalue</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;(</span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">)&#39;</span>  <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opL</span><span class="o">.</span><span class="n">rstring</span><span class="p">(</span><span class="n">lvalue</span><span class="p">)</span> <span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">op_str</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">opR</span><span class="o">.</span><span class="n">rstring</span><span class="p">(</span><span class="n">lvalue</span><span class="p">))</span></div></div>
 


<div class="viewcode-block" id="TwoSameOpExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.TwoSameOpExpression">[文档]</a><span class="k">class</span> <span class="nc">TwoSameOpExpression</span><span class="p">(</span><span class="n">TwoOpExpression</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">opL</span><span class="p">,</span><span class="n">opR</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">opL</span><span class="p">,</span><span class="n">opR</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">opL</span><span class="o">.</span><span class="n">attribute</span> <span class="o">!=</span> <span class="n">opR</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span> <span class="k">raise</span> <span class="n">ErrAttrMismatch</span><span class="p">(</span><span class="s1">&#39;Can not &quot;</span><span class="si">%s</span><span class="s1">&quot; Values with different attributes.&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">op_name</span><span class="p">,</span><span class="n">opL</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span><span class="n">opR</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span></div>


<div class="viewcode-block" id="LeftShift"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.LeftShift">[文档]</a><span class="k">class</span> <span class="nc">LeftShift</span><span class="p">(</span><span class="n">TwoOpExpression</span><span class="p">):</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">opL</span><span class="o">.</span><span class="n">attribute</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;LeftShift(&lt;&lt;)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;&lt;&#39;</span></div>


<div class="viewcode-block" id="RightShift"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.RightShift">[文档]</a><span class="k">class</span> <span class="nc">RightShift</span><span class="p">(</span><span class="n">TwoOpExpression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">opL</span><span class="o">.</span><span class="n">attribute</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;RightShift(&gt;&gt;)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&gt;&gt;&#39;</span></div>





<div class="viewcode-block" id="TwoSameOpU1Expression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.TwoSameOpU1Expression">[文档]</a><span class="k">class</span> <span class="nc">TwoSameOpU1Expression</span><span class="p">(</span><span class="n">TwoSameOpExpression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">UInt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="TwoSameOpBitExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.TwoSameOpBitExpression">[文档]</a><span class="k">class</span> <span class="nc">TwoSameOpBitExpression</span><span class="p">(</span><span class="n">TwoSameOpExpression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">opL</span><span class="o">.</span><span class="n">attribute</span></div>


<span class="c1">################################################################################################################</span>
<span class="c1">#</span>
<span class="c1">#   Two Ops Expression</span>
<span class="c1">#       Arthmatic Expression</span>
<span class="c1">################################################################################################################</span>

<div class="viewcode-block" id="AddExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.AddExpression">[文档]</a><span class="k">class</span> <span class="nc">AddExpression</span><span class="p">(</span><span class="n">TwoSameOpExpression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opL</span><span class="o">.</span><span class="n">attribute</span><span class="p">)(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opL</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">width</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">opR</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">width</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Add(+)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;+&#39;</span></div>




<div class="viewcode-block" id="SubExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.SubExpression">[文档]</a><span class="k">class</span> <span class="nc">SubExpression</span><span class="p">(</span><span class="n">TwoSameOpExpression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opL</span><span class="o">.</span><span class="n">attribute</span><span class="p">)(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opL</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">width</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">opR</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">width</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Sub(-)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;-&#39;</span></div>




<div class="viewcode-block" id="MulExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.MulExpression">[文档]</a><span class="k">class</span> <span class="nc">MulExpression</span><span class="p">(</span><span class="n">TwoSameOpExpression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opL</span><span class="o">.</span><span class="n">attribute</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">opL</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">opR</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Mul(*)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;*&#39;</span></div>



<span class="c1">################################################################################################################</span>
<span class="c1">#</span>
<span class="c1">#   Two Ops Expression</span>
<span class="c1">#       Two Ops Bit Expression</span>
<span class="c1">################################################################################################################</span>

<div class="viewcode-block" id="BitOrExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.BitOrExpression">[文档]</a><span class="k">class</span> <span class="nc">BitOrExpression</span><span class="p">(</span><span class="n">TwoSameOpBitExpression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;BitOr(|)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;|&#39;</span></div>



<div class="viewcode-block" id="BitAndExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.BitAndExpression">[文档]</a><span class="k">class</span> <span class="nc">BitAndExpression</span><span class="p">(</span><span class="n">TwoSameOpBitExpression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;BitAnd(&amp;)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&amp;&#39;</span></div>



<div class="viewcode-block" id="BitXorExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.BitXorExpression">[文档]</a><span class="k">class</span> <span class="nc">BitXorExpression</span><span class="p">(</span><span class="n">TwoSameOpBitExpression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Xor(^)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;^&#39;</span></div>



<div class="viewcode-block" id="BitXnorExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.BitXnorExpression">[文档]</a><span class="k">class</span> <span class="nc">BitXnorExpression</span><span class="p">(</span><span class="n">TwoSameOpBitExpression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;BitXnor(^~)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;^~&#39;</span></div>



<span class="c1">################################################################################################################</span>
<span class="c1">#</span>
<span class="c1">#   Two Ops Expression</span>
<span class="c1">#       Compare Expression</span>
<span class="c1">#</span>
<span class="c1">################################################################################################################</span>

<div class="viewcode-block" id="EqualExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.EqualExpression">[文档]</a><span class="k">class</span> <span class="nc">EqualExpression</span><span class="p">(</span><span class="n">TwoSameOpU1Expression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Equal(==)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;==&#39;</span></div>



<div class="viewcode-block" id="NotEqualExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.NotEqualExpression">[文档]</a><span class="k">class</span> <span class="nc">NotEqualExpression</span><span class="p">(</span><span class="n">TwoSameOpU1Expression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;NotEqual(!=)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;!=&#39;</span></div>



<div class="viewcode-block" id="LessEqualExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.LessEqualExpression">[文档]</a><span class="k">class</span> <span class="nc">LessEqualExpression</span><span class="p">(</span><span class="n">TwoSameOpU1Expression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;LessEqual(&lt;=)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;=&#39;</span></div>



<div class="viewcode-block" id="GreaterEqualExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.GreaterEqualExpression">[文档]</a><span class="k">class</span> <span class="nc">GreaterEqualExpression</span><span class="p">(</span><span class="n">TwoSameOpU1Expression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;GreaterEqual(&gt;=)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&gt;=&#39;</span></div>



<div class="viewcode-block" id="LessExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.LessExpression">[文档]</a><span class="k">class</span> <span class="nc">LessExpression</span><span class="p">(</span><span class="n">TwoSameOpU1Expression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Less(&lt;)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;&#39;</span></div>



<div class="viewcode-block" id="GreaterExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.GreaterExpression">[文档]</a><span class="k">class</span> <span class="nc">GreaterExpression</span><span class="p">(</span><span class="n">TwoSameOpU1Expression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Greater(&gt;)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&gt;&#39;</span></div>



<div class="viewcode-block" id="AndExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.AndExpression">[文档]</a><span class="k">class</span> <span class="nc">AndExpression</span><span class="p">(</span><span class="n">TwoSameOpU1Expression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;And(&amp;&amp;)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&amp;&amp;&#39;</span></div>



<div class="viewcode-block" id="OrExpression"><a class="viewcode-back" href="../../../../pysrc.uhdl.core.html#pysrc.uhdl.core.Variable.OrExpression">[文档]</a><span class="k">class</span> <span class="nc">OrExpression</span><span class="p">(</span><span class="n">TwoSameOpU1Expression</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Or(||)&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;||&#39;</span></div>





    <span class="c1">#     if op1_component.father is op2_component or op2_component.father is op1_component: </span>
    <span class="c1">#         # input  &lt;= input  or</span>
    <span class="c1">#         # output &lt;= output</span>



    <span class="c1">#         if op1.father_until(Component).father is op2.father:</span>
    <span class="c1">#             son_op = op1</span>
    <span class="c1">#             father_op = op2</span>
    <span class="c1">#         else:</span>
    <span class="c1">#             son_op = op2</span>
    <span class="c1">#             father_op = op1</span>

    <span class="c1">#         if isinstance(son_op, Input) and isinstance(father_op, Input):</span>
    <span class="c1">#             son_op += father_op</span>
    <span class="c1">#         elif isinstance(son_op, Output) and isinstance(father_op, Output):</span>
    <span class="c1">#             father_op += son_op</span>
    <span class="c1">#         else:</span>
    <span class="c1">#             raise Exception()</span>

    <span class="c1">#     elif op1.father_until(Component).father is op2.father_unril(Component).father or (outer and op1.father_until(Component) is op2.father_unril(Component)): </span>
    <span class="c1">#         # input &lt;= output</span>
    <span class="c1">#         if isinstance(op1, Input) and isinstance(op2, Output):</span>
    <span class="c1">#             op1 += op2</span>
    <span class="c1">#         elif isinstance(op1, Output) and isinstance(op2, Input):</span>
    <span class="c1">#             op2 += op1</span>
    <span class="c1">#         else:</span>
    <span class="c1">#             raise Exception()</span>


    <span class="c1">#     elif (not outer) and op1.father_until(Component) is op2.father_unril(Component):  </span>
    <span class="c1">#         # output &lt;= input</span>
    <span class="c1">#         if isinstance(op1, Input) and isinstance(op2, Output):</span>
    <span class="c1">#             op2 += op1</span>
    <span class="c1">#         elif isinstance(op1, Output) and isinstance(op2, Input):</span>
    <span class="c1">#             op1 += op2</span>
    <span class="c1">#         else:</span>
    <span class="c1">#             raise Exception()</span>

    <span class="c1">#     else:</span>
    <span class="c1">#         raise Exception(&#39;op1 %s and op2 %s can not connect.&#39; % (op1, op2))</span>







        <span class="c1">#internal</span>
        <span class="c1">#same_lvl</span>
        <span class="c1">#high_lvl</span>
        <span class="c1">#constant</span>
        <span class="c1">#self_module = self.father_until(Component.Component)</span>
        <span class="c1">#ravlue_module = rvalue.father_until(Component.Component)</span>
        <span class="c1"># self_module = self.father_until(Component.Component)</span>
        <span class="c1"># if isinstance(rvalue,CutExpression):</span>
        <span class="c1">#     rvalue_module = rvalue.op.father_until(Component.Component)</span>
        <span class="c1"># elif isinstance(rvalue,Expression):</span>
        <span class="c1">#     rvalue_module = self_module</span>
        <span class="c1"># else:</span>
        <span class="c1">#     rvalue_module = rvalue.father_until(Component.Component)</span>
        <span class="c1"># # visible and direction check</span>
        <span class="c1"># if self_module is rvalue_module:</span>
        <span class="c1">#     if not isinstance(self,(Reg,Wire,Output,Inout)):</span>
        <span class="c1">#         raise ErrUHDLStr(&quot;rvalue(%s) is not a instance of Reg or Wire or Output.&quot;%(rvalue))</span>
        <span class="c1">#     pass</span>
        <span class="c1"># elif self_module.father is rvalue_module:</span>
        <span class="c1">#     if not isinstance(self,(Input,Inout)):</span>
        <span class="c1">#         raise ErrUHDLStr(&quot;lvalue(%s) is not an output port of submodule..&quot;%(self))</span>
        <span class="c1"># elif self_module is rvalue_module.father:</span>
        <span class="c1">#     if not isinstance(self,(Reg,Wire,Output,Inout)):</span>
        <span class="c1">#         raise ErrUHDLStr(&quot;lvalue(%s) is not a instance of Reg or Wire or Output.&quot;%(self))</span>
        <span class="c1">#     if not isinstance(rvalue,Output):</span>
        <span class="c1">#         raise ErrUHDLStr(&quot;rvalue(%s) is not an output port of submodule.&quot;%(rvalue))</span>
        <span class="c1"># elif self_module.father is rvalue_module.father:</span>
        <span class="c1">#     if not isinstance(self,Input):</span>
        <span class="c1">#         raise ErrUHDLStr(&quot;lvalue(%s) is not a instance of Input.&quot;%(self))</span>
        <span class="c1">#     if not isinstance(rvalue,Output):</span>
        <span class="c1">#         raise ErrUHDLStr(&quot;rvalue(%s) is not an a instance of Output.&quot;%(rvalue))</span>
        <span class="c1"># return self</span>



        <span class="c1">#else:</span>
        <span class="c1">#    raise ErrUHDL(&quot;can&#39;t connect two signal cross multi layers&quot;)</span>
    <span class="c1">#raise ArithmeticError(&#39;Left value attribute/Right value attribute mismatch.&#39;)</span>

    <span class="c1">#@property</span>
    <span class="c1">#def name(self) -&gt; str:</span>
    <span class="c1">#    from .Component import Component</span>
    <span class="c1">#    return self.name_until_not(Component)</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2019, Yunqi Liu.</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用的 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a> 开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>